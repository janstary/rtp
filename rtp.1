.\" Copyright (c) 2018 Jan Stary <hans@stare.cz>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\" 
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.Dd June 26, 2018
.Dt RTP 1
.Os
.Sh NAME
.Nm rtp
.Nd debug RTP sessions
.Sh SYNOPSIS
.Nm
.Op input
.Op output
.Sh DESCRIPTION
.Nm
reads a stream of RTP packets from
.Ar input
and writes it to
.Ar output .
Both can be a named file or a network address.
By default,
.Nm
reads from standard input and writes to standard output.
A special name of
.Sq -
also means standard input or output.
A network address is given as
.Oo Ar address Oc Ns Ar :port ,
where
.Ar address
is either an IP address in dot-decimal notation or a hostname
.Po
.Dq localhost
by default
.Pc ,
and
.Ar port
is a number.
.Pp
If the
.Ar output
is a local address
(i.e. any IP address assigned to the local machine),
.Nm
will wait till someone sends a one-byte message to that address
and then will stream the input to them.
Similarly, if the
.Ar input
is a remote address
(i.e. any address not assigned to the local machine),
.Nm
will try to send a one-byte message first
to let them know we are reading.
.\"This is needed because RTP operates via UDP,
.\"so neither side knows someone has connected
.\"until actually seeing something arrive.
.\" FIXME opravdu? Jak to zjistuje treba nc(1). IMHO neco posle.
For other combinations of input and output,
.Nm
behaves in the obvious way.
.Sh EXAMPLES
Read from a file, write to a file:
.Dl $ rtp infile outfile
.Pp
Read from a file, stream the content to whoever connects to us:
.Dl $ rtp infile 192.168.1.1:1234
.Pp
Read from a file, stream the content to a remote location:
.Dl $ rtp infile host.domain.com:1234
.Pp
Read on a local port, dump to a file:
.Dl $ rtp 192.168.1.1:1234 outfile
.Pp
Read on a local port, stream it out on another local port:
.Dl $ rtp 192.168.1.1:1234 192.168.12.34:6666
.Pp
Read on a local port, stream it to a remote location:
.Dl $ rtp 192.168.1.1:1234 host.domain.com:6666
.Pp
Read from a remote location, dump to a file:
.Dl $ rtp host.domain.com:1234 outfile
.Sh HISTORY
In the early days of RTP, Henning Schulzrinne wrote a set of
.Dq rtptools
to debug RTP sessions on packet level.
This is a complete rewrite, supporting the rtptools dump format
for backwards compatibility.
.Pp
Reading a local file and streaming it to a remote location
is what rtpplay and rtpsend does.
Reading a local port and dumping it to a file
is what rtpdump does.
Reading from an address and streaming to another address
is what rtptrans does.
.Sh AUTHORS
.An Jan Star√Ω Aq Mt hans@stare.cz
.Sh BUGS
By convention, RTP traffic happens on an even port number,
and the corresponding RTCP happens on the odd port+1.
.Nm
ignores that convention, only reads the specified
.Ar port ,
and misses the RTCP packets.
